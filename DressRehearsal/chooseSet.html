<! DOCTYPE html>
<html>
  <head>
    <title>Rehearsal - Choose Card Set</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="bigTile">
        <label for="cars">Choose a card set:</label>
    
        <select name="cars" id="data" onchange>
          <option value="D1.I-Zahlen.txt">D1: Intro: Zahlen</option>
          <option value="D1.I-Vokab.txt">D1: Intro: Vokab</option>
          <option value="AP-B3.Ch2.2-Gemeinschaften.txt">AP: B3 2.2: Gemeinschaften</option>
        </select>
        <button onclick="setData()">Go!</button>
    </div>
    <script>
      function setCookie(cname, cvalue, exdays) { //general function that pushes the cookie to the server
    const d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    let expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
  }

  function getCookie(cname) { //general function that grabs cookie from server
    let name = cname + "=";
    let ca = document.cookie.split(';');
    for(let i = 0; i < ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return "";
  }

  var dataSheets= new Array();
  var ddl = document.getElementById("data");
  for (i = 0; i < ddl.options.length; i++) {
     dataSheets[i] = ddl.options[i].value;
  }
  //dataSheets = ["test1.txt", "test2.txt", "mercedes", "wrong"]; //UPDATE THIS AT SOME POINT

      function getDataFromCookie(){ //data getCookie
          let d = getCookie("dataSheet");
          //window.alert(d);
          if (d==""){
          window.alert("No data sheet selected!");
          }
          else if(dataSheets.includes(d)){
            window.alert("Data sheet loaded! " + d);
            window.location.replace("https://goosejacket.github.io/GooseSite/DressRehearsal/main.html");
          }
          else window.alert("Uh. Something. Uh. Something went wrong. Yell at Ang at laladgdg@gmail.com to fix it, tell her 'something with the cookies pulling data on chooseSet.html'");
        }  

         function setData(){ //data setCookie
           let x = document.getElementById("data").value;
           setCookie("dataSheet", x, 365);
           getDataFromCookie();
         }
          </script>
  </body>
</html>
